{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/laragon/www/chillocreative/frontend/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\r\n\r\nexport const prisma =\r\n    globalForPrisma.prisma ||\r\n    new PrismaClient({\r\n        log: ['query'],\r\n    });\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACT,gBAAgB,MAAM,IACtB,IAAI,sMAAY,CAAC;IACb,KAAK;QAAC;KAAQ;AAClB;AAEJ,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 69, "column": 0}, "map": {"version":3,"sources":["file:///D:/laragon/www/chillocreative/frontend/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { prisma } from '@/lib/prisma';\r\nimport bcrypt from 'bcryptjs';\r\nimport { SignJWT } from 'jose';\r\nimport { cookies } from 'next/headers';\r\n\r\nconst JWT_SECRET = new TextEncoder().encode(\r\n    process.env.JWT_SECRET || 'rahim-chillo-secret-1977'\r\n);\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const { username, password } = await request.json();\r\n\r\n        if (!username || !password) {\r\n            return NextResponse.json(\r\n                { error: 'Username and password are required' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const user = await prisma.user.findFirst({\r\n            where: {\r\n                OR: [\r\n                    { username: username },\r\n                    { email: username }\r\n                ]\r\n            },\r\n        });\r\n\r\n        if (!user) {\r\n            return NextResponse.json(\r\n                { error: 'Invalid credentials' },\r\n                { status: 401 }\r\n            );\r\n        }\r\n\r\n        const passwordMatch = await bcrypt.compare(password, user.password);\r\n\r\n        if (!passwordMatch) {\r\n            return NextResponse.json(\r\n                { error: 'Invalid credentials' },\r\n                { status: 401 }\r\n            );\r\n        }\r\n\r\n        // Create JWT\r\n        const token = await new SignJWT({\r\n            userId: user.id,\r\n            username: user.username,\r\n            role: user.role\r\n        })\r\n            .setProtectedHeader({ alg: 'HS256' })\r\n            .setIssuedAt()\r\n            .setExpirationTime('24h')\r\n            .sign(JWT_SECRET);\r\n\r\n        // Set cookie\r\n        const cookieStore = await cookies();\r\n        cookieStore.set('admin_token', token, {\r\n            httpOnly: true,\r\n            secure: process.env.NODE_ENV === 'production',\r\n            sameSite: 'lax',\r\n            maxAge: 60 * 60 * 24, // 24 hours\r\n            path: '/',\r\n        });\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            user: {\r\n                id: user.id,\r\n                username: user.username,\r\n                name: user.name,\r\n                role: user.role\r\n            }\r\n        });\r\n    } catch (error) {\r\n        console.error('Login error:', error);\r\n        return NextResponse.json(\r\n            { error: 'Internal server error' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM,aAAa,IAAI,cAAc,MAAM,CACvC,QAAQ,GAAG,CAAC,UAAU,IAAI;AAGvB,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEjD,IAAI,CAAC,YAAY,CAAC,UAAU;YACxB,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAqC,GAC9C;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,OAAO,MAAM,yHAAM,CAAC,IAAI,CAAC,SAAS,CAAC;YACrC,OAAO;gBACH,IAAI;oBACA;wBAAE,UAAU;oBAAS;oBACrB;wBAAE,OAAO;oBAAS;iBACrB;YACL;QACJ;QAEA,IAAI,CAAC,MAAM;YACP,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,gBAAgB,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;QAElE,IAAI,CAAC,eAAe;YAChB,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAEtB;QAEA,aAAa;QACb,MAAM,QAAQ,MAAM,IAAI,kKAAO,CAAC;YAC5B,QAAQ,KAAK,EAAE;YACf,UAAU,KAAK,QAAQ;YACvB,MAAM,KAAK,IAAI;QACnB,GACK,kBAAkB,CAAC;YAAE,KAAK;QAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,OAClB,IAAI,CAAC;QAEV,aAAa;QACb,MAAM,cAAc,MAAM,IAAA,4IAAO;QACjC,YAAY,GAAG,CAAC,eAAe,OAAO;YAClC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK;YAClB,MAAM;QACV;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,MAAM;gBACF,IAAI,KAAK,EAAE;gBACX,UAAU,KAAK,QAAQ;gBACvB,MAAM,KAAK,IAAI;gBACf,MAAM,KAAK,IAAI;YACnB;QACJ;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}